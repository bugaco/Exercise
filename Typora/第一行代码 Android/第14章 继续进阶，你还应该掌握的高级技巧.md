## 14.1 获取 Context 的技巧

#### 1⃣️新建`MyApplication`类，继承自`Application`

```kotlin
class MyApplication: Application() {
    companion object {
        lateinit var context: Context
    }

    override fun onCreate() {
        super.onCreate()
        context = applicationContext
    }
}
```

#### 2⃣️在 Manifest 中配置，修改默认加载的 Application：

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.zanyzephyr.androidtricktest">

    <application
        ...
        android:name=".MyApplication">
        ...

</manifest>
```



然后就可以在任意地方调用了。比如 Toast 的封装就可以zheyangxiel：

```kotlin
fun String.makeToast() {
    Toast.makeText(MyApplication.context, this, Toast.LENGTH_SHORT).show()
}
```



在两个不同的 Activity 中调用 `makeToast` 发现，`MyApplication.context`表示的是顶层的 activity ：

<img src="https://tva1.sinaimg.cn/large/007S8ZIlly1ge8i86q2twj30ma10wjvs.jpg" alt="image-20200427183225422" style="zoom: 33%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlly1ge8i8mlj23j30ls11m0wp.jpg" alt="image-20200427183250734" style="zoom:33%;" />

## 14.2 使用 Intent 传递对象

### 14.2.1 Serializable

创建 Person 类，使其实现 Serializable 接口：

```kotlin
class Person(val name: String, val age: Int): Serializable {

}
```

然后就可以这样传值了：

```kotlin
// 传递
        jumpButton.setOnClickListener {
            val intent = Intent(this, Activity2::class.java)
            val me = Person("李懿哲", 30)
            intent.putExtra("person", me)
            startActivity(intent)
        }
// 接收
class Activity2 : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        ...

        val me = intent.getSerializableExtra("person") as Person
        if (me != null) {
            textView2.text = me.name
        }

        ...
    }
}
```

### 14.2.2 Parcelable

直接用 Kotlin 提供的简单写法吧：

```kotlin
@Parcelize
class Person(val name: String, val age: Int): Parcelable {

}
```

调用和 Serializable 相似：

```kotlin
...
val me = intent.getParcelableExtra("person") as Person
...
```



## 14.3 定制自己的日志工具

```kotlin
object LogUtil {

    private const val VERBOSE = 1
    private const val DEBUG = 2
    private const val INFO = 3
    private const val WARN = 4
    private const val ERROR = 5

    private var level = VERBOSE

    fun v(tag: String, msg: String) {
        if (level <= VERBOSE) {
            Log.v(tag, msg)
        }
    }
    fun d(tag: String, msg: String) {
        if (level <= DEBUG) {
            Log.d(tag, msg)
        }
    }
    fun i(tag: String, msg: String) {
        if (level <= INFO) {
            Log.i(tag, msg)
        }
    }
    fun w(tag: String, msg: String) {
        if (level <= WARN) {
            Log.w(tag, msg)
        }
    }
    fun e(tag: String, msg: String) {
        if (level <= ERROR) {
            Log.e(tag, msg)
        }
    }
}

fun main() {
    LogUtil.d("tag", "debug test")
}
```

## 14.4 调试 Android 程序

原来 Android studio 也是可以在运行模式转 debug 模式的，运行时点击如下按钮即可转换：

![image-20200427212416376](https://tva1.sinaimg.cn/large/007S8ZIlly1ge8n70lcl5j30g204aq38.jpg)

## 14.5 深色主题

TODO



## 14.6 Kotlin 课堂：Java 与 Kotlin 代码之间的转换

